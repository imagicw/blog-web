import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n,R as p}from"./index.Cq4AiLjf.js";import"./_commonjsHelpers.CqkleIqs.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),k=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),b=a=>{const t=k(a);return t.charAt(0).toUpperCase()+t.slice(1)},f=(...a)=>a.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim(),j=a=>{for(const t in a)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var v={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=n.forwardRef(({color:a="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:d="",children:i,iconNode:c,...u},g)=>n.createElement("svg",{ref:g,...v,width:t,height:t,stroke:a,strokeWidth:s?Number(r)*24/Number(t):r,className:f("lucide",d),...!i&&!j(u)&&{"aria-hidden":"true"},...u},[...c.map(([l,m])=>n.createElement(l,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=(a,t)=>{const r=n.forwardRef(({className:s,...d},i)=>n.createElement(N,{ref:i,iconNode:t,className:f(`lucide-${w(b(a))}`,`lucide-${a}`,s),...d}));return r.displayName=b(a),r};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],A=C("music",L);function P(){const[a,t]=n.useState(!1),[r,s]=n.useState(null),[d,i]=n.useState(!0),c=p.useRef(0),u=async()=>{if(!(c.current>5))try{const l=await fetch("/api/music/now");if(l.ok){const m=await l.json();c.current=0;const x=m.recenttracks.track,o=Array.isArray(x)?x[0]:x;if(o){const y=o["@attr"]?.nowplaying==="true";t(y),s({name:o.name,artist:o.artist["#text"],album:o.album["#text"],albumMbid:o.album.mbid||"",image:o.image.find(h=>h.size==="large")?.["#text"]||o.image[0]?.["#text"]})}}else c.current+=1}catch(l){console.error("Error fetching music status:",l),c.current+=1}finally{c.current>5&&console.warn("Music status fetching stopped due to repeated failures."),i(!1)}};if(n.useEffect(()=>{u();const l=setInterval(u,3e4);return()=>clearInterval(l)},[]),d)return e.jsxs("div",{className:"flex items-center gap-6 p-4 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm max-w-md mx-auto mb-12 animate-pulse",children:[e.jsx("div",{className:"shrink-0",children:e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 dark:bg-gray-700"})}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1 gap-2",children:[e.jsx("div",{className:"h-3 w-20 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-6 w-3/4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 w-1/2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-3 w-1/3 bg-gray-200 dark:bg-gray-700 rounded"})]})]});const g=r?.albumMbid&&r?.image?r.image:"/assets/avatar.jpg";return e.jsxs("div",{className:"flex items-center gap-6 p-4 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm max-w-md mx-auto mb-12",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsxs("div",{className:`w-28 h-28 rounded-full bg-black flex items-center justify-center shadow-lg relative overflow-hidden ring-4 ring-black/10 dark:ring-white/10 ${a?"animate-[spin_4s_linear_infinite]":""}`,style:{animationPlayState:a?"running":"paused"},children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-10 border-transparent border-t-gray-800/20 border-b-gray-800/20 opacity-50"}),e.jsx("div",{className:"absolute inset-2 rounded-full border border-gray-800 opacity-20"}),e.jsx("div",{className:"absolute inset-4 rounded-full border border-gray-800 opacity-20"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-gray-800 opacity-20"}),e.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-200 overflow-hidden relative z-10",children:e.jsx("img",{src:g,alt:r?.album||"Album Cover",className:"w-full h-full object-cover",width:14,height:14,onLoad:l=>{l.target.classList.add("loaded")}})})]}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-linear-to-tr from-transparent via-white/20 to-transparent pointer-events-none z-10"}),e.jsx("div",{className:"absolute -top-3 -right-6 w-24 h-24 pointer-events-none transition-transform duration-1000 ease-in-out origin-[75%_15%]",style:{transform:a?"rotate(15deg)":"rotate(0deg)"},children:e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full drop-shadow-md",children:[e.jsx("circle",{cx:"75",cy:"15",r:"6",className:"fill-gray-400 dark:fill-gray-500 stroke-2 stroke-white dark:stroke-gray-800"}),e.jsx("path",{d:"M 75 15 L 75 85",className:"stroke-gray-300 dark:stroke-gray-600 stroke-4",strokeLinecap:"round"}),e.jsx("rect",{x:"70",y:"75",width:"10",height:"16",rx:"2",className:"fill-gray-400 dark:fill-gray-500"})]})})]}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 text-xs font-medium text-blue-600 dark:text-blue-400 mb-1 uppercase tracking-wider",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500"})]}),"Now Playing"]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-3 h-3"}),"Last Played"]})}),e.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100 truncate text-lg",title:r?.name,children:r?.name||"Not Listening"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm truncate",title:r?.artist,children:r?.artist||"Î›W Music"}),r?.album&&e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs truncate mt-1",title:r.album,children:r.album})]})]})}function I(){return e.jsx(P,{})}export{I as default};
